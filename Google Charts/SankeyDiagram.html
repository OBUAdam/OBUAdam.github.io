<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script>
    google.charts.load('current', { 'packages': ['sankey'] });
    google.charts.setOnLoadCallback(drawChart);

    var rawData = [
        ['Various Google Alerts', '00H', 3],
        ['Sleep As Android', '00H', 1],
        ['Telegram', '00H', 1],
        ['Accuweather', '01H', 1],
        ['ATs Weather', '01H', 1],
        ['Various Google Alerts', '02H', 1],
        ['Golf Game', '02H', 1],
        ['Weather Radar App', '02H', 1],
        ['Various Google Alerts', '03H', 1],
        ['Twitter', '03H', 1],
        ['Various Google Alerts', '04H', 2],
        ['Various Google Alerts', '05H', 2],
        ['Phone Clock App', '05H', 1],
        ['Google Clock App', '06H', 1],
        ['Various Google Alerts', '06H', 1],
        ['Telegram', '06H', 2],
        ['Google Clock App', '07H', 1],
        ['Various Google Alerts', '07H', 2],
        ['Twitter', '07H', 1],
        ['Sleep As Android', '07H', 1],
        ['Various Google Alerts', '08H', 1],
        ['MS Teams', '08H', 3],
        ['Sleep As Android', '08H', 2],
        ['Google Photos', '09H', 1],
        ['Google Calendar', '09H', 1],
        ['Google Mobile Services', '09H', 1],
        ['Various Google Alerts', '09H', 1],
        ['Amazon Photos', '10H', 2],
        ['Google Mobile Services', '10H', 1],
        ['Various Google Alerts', '10H', 2],
        ['Hangouts', '10H', 5],
        ['MS Teams', '10H', 18],
        ['Sleep As Android', '10H', 1],
        ['Amazon Shopping', '11H', 1],
        ['Android Messages', '11H', 1],
        ['Google Mobile Services', '11H', 1],
        ['Hangouts', '11H', 6],
        ['MS Teams', '11H', 25],
        ['Google Calendar', '12H', 1],
        ['Various Google Alerts', '12H', 2],
        ['Hangouts', '12H', 1],
        ['AutoRemote', '12H', 2],
        ['MS Teams', '12H', 5],
        ['Telegram', '12H', 3],
        ['Call Recorder', '13H', 1],
        ['Phone App', '13H', 1],
        ['Google Mobile Services', '13H', 2],
        ['Various Google Alerts', '13H', 2],
        ['Hangouts', '13H', 1],
        ['MS Teams', '13H', 1],
        ['Telegram', '13H', 1],
        ['Various Google Alerts', '14H', 2],
        ['MS Teams', '14H', 17],
        ['MarcoPolo', '15H', 1],
        ['Various Google Alerts', '15H', 1],
        ['AutoRemote', '15H', 4],
        ['MS Teams', '15H', 10],
        ['Bible App', '15H', 1],
        ['MarcoPolo', '16H', 14],
        ['Accuweather', '16H', 2],
        ['Various Google Alerts', '16H', 1],
        ['MS Teams', '16H', 4],
        ['Netflix', '16H', 1],
        ['Accuweather', '17H', 3],
        ['Google Calendar', '17H', 1],
        ['AutoRemote', '17H', 1],
        ['MS Teams', '17H', 2],
        ['TSheets', '17H', 2],
        ['MarcoPolo', '18H', 3],
        ['Accuweather', '18H', 3],
        ['Various Google Alerts', '18H', 1],
        ['MS Teams', '18H', 1],
        ['Weather Radar App', '18H', 1],
        ['Twitter', '18H', 1],
        ['Various Google Alerts', '19H', 1],
        ['Hangouts', '19H', 2],
        ['AutoRemote', '19H', 3],
        ['Telegram', '19H', 3],
        ['MarcoPolo', '20H', 3],
        ['Google Fit', '20H', 1],
        ['Hangouts', '20H', 1],
        ['AutoRemote', '20H', 3],
        ['Weather Radar App', '20H', 1],
        ['Telegram', '20H', 3],
        ['Various Google Alerts', '21H', 1],
        ['AutoRemote', '21H', 1],
        ['MarcoPolo', '22H', 2],
        ['Various Google Alerts', '22H', 2],
        ['Hangouts', '22H', 1],
        ['AutoRemote', '22H', 2],
        ['Weather Radar App', '22H', 1],
        ['Various Google Alerts', '23H', 1],
    ];

    var sourceTotals = {};

    for (var i = 0; i < rawData.length; i++) {
        var item = rawData[i],
            key = item[0];
        if (sourceTotals.hasOwnProperty(key)) {
            sourceTotals[key] += item[2];
        }
        else {
            sourceTotals[key] = item[2];
        }
    }

    var destTotals = {};

    for (var i = 0; i < rawData.length; i++) {
        var item = rawData[i],
            key = item[1];
        if (destTotals.hasOwnProperty(key)) {
            destTotals[key] += item[2];
        }
        else {
            destTotals[key] = item[2];
        }
    }

    rawData.forEach( function(d) {
        d[0] = d[0] + " (" + sourceTotals[d[0]] + ")";
        d[1] = d[1] + " (" + destTotals[d[1]] + ")";
    });

    function drawChart() {
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'From');
        data.addColumn('string', 'To');
        data.addColumn('number', 'Weight');
        data.addRows(rawData);

        var options = {
            width: 1500,
            height: 800,
            sankey: {
                iterations: 0,
                node: {
                    width: 25, colorMode: 'unique',
                    label: {
                        bold: true
                    },
                    nodePadding: 10
                },
                link: { colorMode: 'source' }
            }
        };

        data.sort([{ column: 1 }]);

        // Instantiates and draws our chart, passing in some options.
        var chart = new google.visualization.Sankey(document.getElementById('sankey_Notifications'));
        chart.draw(data, options);
    }
</script>
<div id="sankey_Notifications"></div>
